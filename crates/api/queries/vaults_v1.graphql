# Fragments for shared field selections
fragment MarketStateFields on MarketState {
  supplyAssets
  borrowAssets
  supplyShares
  borrowShares
  timestamp
  fee
  rateAtTarget
  price
}

fragment MarketFields on Market {
  uniqueKey
  lltv
  loanAsset {
    address
    symbol
  }
  collateralAsset {
    address
    symbol
  }
  state {
    ...MarketStateFields
  }
}

fragment AllocationFields on VaultAllocation {
  market {
    ...MarketFields
  }
  supplyAssets
  supplyAssetsUsd
  supplyCap
  enabled
  supplyQueueIndex
  withdrawQueueIndex
}

fragment VaultStateFields on VaultState {
  totalAssets
  totalAssetsUsd
  totalSupply
  apy
  netApy
  sharePrice
  fee
  timelock
  curator
  owner
  guardian
  allocation {
    ...AllocationFields
  }
}

fragment VaultFields on Vault {
  id
  address
  name
  symbol
  listed
  featured
  whitelisted
  chain {
    id
    network
  }
  asset {
    address
    symbol
    decimals
    name
    priceUsd
  }
  state {
    ...VaultStateFields
  }
  allocators {
    address
  }
  warnings {
    type
    level
  }
}

query GetVaultsV1(
  $first: Int
  $skip: Int
  $where: VaultFilters
  $orderBy: VaultOrderBy
  $orderDirection: OrderDirection
) {
  vaults(first: $first, skip: $skip, where: $where, orderBy: $orderBy, orderDirection: $orderDirection) {
    items {
      ...VaultFields
    }
    pageInfo {
      count
      countTotal
    }
  }
}

query GetVaultV1ByAddress($address: String!, $chainId: Int!) {
  vaultByAddress(address: $address, chainId: $chainId) {
    ...VaultFields
  }
}
